<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EXACT (Exact-Sparse) - Theory - AGISystem2</title>
  <link rel="stylesheet" href="../../reference/style.css">
  <style>
    .concept-box {
      background: linear-gradient(135deg, #e8eaf622 0%, #c5cae922 100%);
      border-left: 4px solid #3f51b5;
      padding: 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }
    .concept-box h4 { margin-top: 0; color: #283593; }
    .definition {
      background: #fff3e0;
      border: 1px solid #ffb74d;
      padding: 15px 20px;
      border-radius: 8px;
      margin: 15px 0;
    }
    .definition strong { color: #e65100; }
    .math-block {
      background: #263238;
      color: #c5e1a5;
      padding: 18px 20px;
      border-radius: 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      overflow-x: auto;
      margin: 15px 0;
      font-size: 13px;
      line-height: 1.4;
    }
    .note {
      background: #e3f2fd;
      border: 1px solid #64b5f6;
      padding: 15px 20px;
      border-radius: 8px;
      margin: 15px 0;
    }
  </style>
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>EXACT (Exact-Sparse Bitset Polynomial)</h1>
    <small>
      <a href="../../index.html">Home</a> &middot;
      <a href="../index.html">Theory</a> &middot;
      <a href="dense-binary.html">Dense-Binary</a> &middot;
      <a href="sparse-polynomial.html">SPHDC</a> &middot;
      <a href="metric-affine.html">Metric-Affine</a> &middot;
      <a href="metric-affine-elastic.html">Metric-Affine Elastic</a> &middot;
      <a href="exact.html"><strong>EXACT</strong></a>
    </small>
    <small>Lossless, session-local atom IDs (DS25)</small>
  </div>

  <div class="section-intro">
    <p><strong>EXACT</strong> is a lossless HDC strategy: atoms are encoded as one-hot <code>BigInt</code> bits, and a vector is a <strong>set of bitset-monomials</strong>. It is designed to explore the limits of fully deterministic, collision-free representations inside a session.</p>
    <p>Spec: <a href="../../specsLoader.html?spec=DS/DS25-Exact-Sparse-Bitset-Polynomial-HDC.md">DS25 — EXACT / Exact-Sparse</a></p>
  </div>

  <h2>1. Representation</h2>

  <div class="definition">
    <strong>Atom</strong>
    <p>Each atom name gets a session-local appearance index <code>i</code>, and the atom vector is one-hot:</p>
    <div class="math-block">Atom(name) = 2^i  (BigInt one-hot)</div>
  </div>

  <div class="definition">
    <strong>Vector (Polynomial)</strong>
    <p>A vector is a sorted unique array of monomials, and each monomial is a <code>BigInt</code> bitset of included atoms:</p>
    <div class="math-block">Vector = { m0, m1, ... }   where each m is a bitset BigInt</div>
  </div>

  <div class="concept-box">
    <h4>Why this matters</h4>
    <p>There is no PRNG/hash identity for atoms. If the session sees the same declarations in the same order, atom identity is exact and reproducible. This trades “global name hashing” for a session-owned dictionary.</p>
  </div>

  <h2>2. Operations (BIND / UNBIND / BUNDLE)</h2>

  <div class="definition">
    <strong>BUNDLE = union</strong>
    <div class="math-block">bundle(V1, V2, ...) = V1 ∪ V2 ∪ ...</div>
    <p>Lossless superposition: the KB is literally the set of all fact-monomials.</p>
  </div>

  <div class="definition">
    <strong>BIND = OR-product</strong>
    <p>Monomial×monomial uses set-union over atoms (bitwise OR). Polynomial bind is the cross-product:</p>
    <div class="math-block">bind(A, B) = { a OR b | a ∈ A, b ∈ B }</div>
  </div>

  <div class="definition">
    <strong>UNBIND = quotient-like extraction (UNBIND_A)</strong>
    <p>EXACT does not require <code>UNBIND ≡ BIND</code>. UNBIND extracts residual parts by subset matching:</p>
    <div class="math-block">unbind(T, Q) = { t \\ q | t ∈ T, q ∈ Q, q ⊆ t }</div>
    <p>This aligns with the “KB is a set of facts” model: it finds all facts that contain the query key, then removes the known part.</p>
  </div>

  <h3>Visual intuition</h3>
  <svg viewBox="0 0 900 290" xmlns="http://www.w3.org/2000/svg" style="width: 100%; max-width: 900px;">
    <text x="450" y="25" text-anchor="middle" font-weight="bold" font-size="14" fill="#3f51b5">EXACT Fact Encoding &amp; Query Extraction</text>

    <!-- Fact monomial -->
    <rect x="40" y="55" width="340" height="190" rx="12" fill="#e8eaf6" stroke="#3f51b5" stroke-width="2"/>
    <text x="210" y="82" text-anchor="middle" font-weight="bold" font-size="12" fill="#283593">Fact term (one monomial)</text>

    <!-- Bits -->
    <g font-size="11" fill="white">
      <rect x="70" y="100" width="90" height="28" rx="8" fill="#3f51b5"/><text x="115" y="119" text-anchor="middle">Op</text>
      <rect x="170" y="100" width="90" height="28" rx="8" fill="#3f51b5"/><text x="215" y="119" text-anchor="middle">Pos1</text>
      <rect x="270" y="100" width="90" height="28" rx="8" fill="#3f51b5"/><text x="315" y="119" text-anchor="middle">Book</text>

      <rect x="70" y="145" width="90" height="28" rx="8" fill="#3f51b5"/><text x="115" y="164" text-anchor="middle">Pos2</text>
      <rect x="170" y="145" width="90" height="28" rx="8" fill="#3f51b5"/><text x="215" y="164" text-anchor="middle">Key</text>
      <rect x="270" y="145" width="90" height="28" rx="8" fill="#3f51b5"/><text x="315" y="164" text-anchor="middle">Pos3</text>

      <rect x="170" y="190" width="90" height="28" rx="8" fill="#3f51b5"/><text x="215" y="209" text-anchor="middle">Idea</text>
    </g>

    <!-- Query key -->
    <rect x="520" y="70" width="340" height="70" rx="12" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
    <text x="690" y="95" text-anchor="middle" font-weight="bold" font-size="12" fill="#e65100">QueryKey (known part)</text>
    <g font-size="11" fill="white">
      <rect x="540" y="108" width="80" height="24" rx="8" fill="#ff9800"/><text x="580" y="125" text-anchor="middle">Op</text>
      <rect x="625" y="108" width="80" height="24" rx="8" fill="#ff9800"/><text x="665" y="125" text-anchor="middle">Pos1+Book</text>
      <rect x="710" y="108" width="130" height="24" rx="8" fill="#ff9800"/><text x="775" y="125" text-anchor="middle">Pos2+Key</text>
    </g>

    <!-- Unbind arrow -->
    <path d="M380 150 C430 150 465 125 505 120" stroke="#444" stroke-width="2" fill="none" marker-end="url(#arrowE)"/>
    <text x="445" y="132" text-anchor="middle" font-size="11" fill="#444">UNBIND_A</text>

    <!-- Residual -->
    <rect x="520" y="160" width="340" height="85" rx="12" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
    <text x="690" y="185" text-anchor="middle" font-weight="bold" font-size="12" fill="#2e7d32">Residual</text>
    <g font-size="11" fill="white">
      <rect x="585" y="200" width="90" height="28" rx="8" fill="#4caf50"/><text x="630" y="219" text-anchor="middle">Pos3</text>
      <rect x="685" y="200" width="90" height="28" rx="8" fill="#4caf50"/><text x="730" y="219" text-anchor="middle">Idea</text>
    </g>

    <defs>
      <marker id="arrowE" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
        <path d="M0,0 L0,6 L9,3 z" fill="#444"/>
      </marker>
    </defs>
  </svg>

	  <div class="note">
	    <strong>Implementation note:</strong> EXACT uses a session-local atom dictionary. At the moment AGISystem2 typically reloads theories from text and re-vectorizes each run, so dictionary persistence is deferred; when KB serialization becomes a workflow, the dictionary must be serialized alongside the KB.
	  </div>
	
	  <h2>3. Decoding / Cleanup (making holographic answers “real”)</h2>
	
	  <p>
	    In XOR-based HDC, unbinding often returns a vector that can be compared directly by similarity. In EXACT, <code>UNBIND</code> is
	    quotient-like, so its output is a <em>residual</em> that frequently contains structural atoms (e.g., position markers and operator tags).
	    A raw similarity score can be misleading (e.g., many candidates appear as <code>0.000</code>).
	  </p>
	
	  <div class="definition">
	    <strong>Strategy-aware projection</strong>
	    <p>
	      The EXACT strategy exposes an optional decoder hook (<code>decodeUnboundCandidates()</code>) that maps residual bitsets back to
	      likely entity atoms by counting witnesses and filtering structural residue. The holographic query engine uses this hook when present,
	      reducing unnecessary similarity scans and producing interpretable top-k candidates.
	    </p>
	  </div>
	
	  <div class="concept-box">
	    <h4>UNBIND variants</h4>
	    <p>
	      EXACT can operate in multiple UNBIND modes. In evaluation runners you may see <strong>EXACT(A)</strong> (existential quotient: “emit residuals for matches”)
	      and <strong>EXACT(B)</strong> (residual intersection across component terms, stricter). Both preserve losslessness; they trade speed vs. strictness.
	    </p>
	  </div>

	  </div>
	</body>
	</html>
