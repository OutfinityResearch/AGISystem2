<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Relations & Custom Verbs</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>AGISystem2 – Relations & Custom Verbs</h1>
    <small>
      <a href="../index.html">Home</a> ·
      <a href="conceptual_spaces.html">Theory</a> ·
      <a href="../architecture/index.html">Architecture</a> ·
      <a href="../api/index.html">APIs</a> ·
      <a href="../syntax/index.html">Syntax</a> ·
      <a href="../usage-cli/index.html">CLI</a> ·
      <a href="../wiki/index.html">Wiki</a> ·
      <a href="../specs/matrix.html">Specs</a>
    </small>
    <div class="sub-nav">
      <strong>Theory:</strong>
      <a href="conceptual_spaces.html">Conceptual Spaces</a> ·
      <a href="reasoning.html">Reasoning</a> ·
      <a href="relations.html">Relations</a> ·
      <a href="bias.html">Bias & Values</a> ·
      <a href="explainability.html">Explainability</a> ·
      <a href="learning.html">Learning</a> ·
      <a href="limits.html">Limits</a>
    </div>
  </div>

  <p>Relations are the verbs of the knowledge system. They connect subjects to objects and determine how vectors are combined during encoding. This page explains how relations work geometrically, lists the built-in relation types, and describes how to define custom verbs.</p>

  <h2>How Relations Work</h2>

  <div class="diagram">
    <svg viewBox="0 0 520 180" role="img" aria-label="Relation encoding with permutation">
      <defs>
        <marker id="arrow-rel" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L6,3 L0,6 z" fill="#0f4c81" />
        </marker>
      </defs>

      <!-- Subject vector -->
      <rect x="20" y="50" width="100" height="40" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="2"/>
      <text x="30" y="72" font-size="10" fill="#0f4c81">v(Subject)</text>
      <text x="30" y="85" font-size="8" fill="#4a5670">"Dog"</text>

      <!-- Object vector -->
      <rect x="20" y="110" width="100" height="40" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="2"/>
      <text x="30" y="132" font-size="10" fill="#0f4c81">v(Object)</text>
      <text x="30" y="145" font-size="8" fill="#4a5670">"Animal"</text>

      <!-- Permutation -->
      <rect x="150" y="110" width="100" height="40" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="2"/>
      <text x="160" y="132" font-size="10" fill="#e65100">π(Relation)</text>
      <text x="160" y="145" font-size="8" fill="#4a5670">IS_A permutation</text>

      <!-- Permuted object -->
      <rect x="280" y="110" width="100" height="40" rx="4" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
      <text x="290" y="132" font-size="10" fill="#2e7d32">π(v(Object))</text>
      <text x="290" y="145" font-size="8" fill="#4a5670">Permuted</text>

      <!-- Addition -->
      <circle cx="420" cy="90" r="25" fill="#f5f7fb" stroke="#0f4c81" stroke-width="2"/>
      <text x="412" y="95" font-size="16" fill="#0f4c81">+</text>

      <!-- Result -->
      <rect x="460" y="70" width="50" height="40" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="2"/>
      <text x="470" y="95" font-size="10" fill="#0f4c81">Fact</text>

      <!-- Arrows -->
      <line x1="120" y1="70" x2="395" y2="75" stroke="#0f4c81" stroke-width="1.5" marker-end="url(#arrow-rel)"/>
      <line x1="120" y1="130" x2="148" y2="130" stroke="#0f4c81" stroke-width="1.5" marker-end="url(#arrow-rel)"/>
      <line x1="250" y1="130" x2="278" y2="130" stroke="#e65100" stroke-width="1.5" marker-end="url(#arrow-rel)"/>
      <line x1="380" y1="130" x2="395" y2="105" stroke="#2e7d32" stroke-width="1.5" marker-end="url(#arrow-rel)"/>
      <line x1="445" y1="90" x2="458" y2="90" stroke="#0f4c81" stroke-width="1.5" marker-end="url(#arrow-rel)"/>

      <!-- Formula -->
      <text x="200" y="30" font-size="11" fill="#0f4c81">encode(S, R, O) = v(S) + π_R(v(O))</text>
    </svg>
    <p class="diagram-caption">Encoding a fact: The object vector is permuted according to the relation, then added to the subject vector with saturating arithmetic. Different relations use different permutations, keeping the dimensionality fixed while encoding role information.</p>
  </div>

  <p>Each relation has a unique permutation table that reorders vector dimensions. When encoding "Dog IS_A Animal", the system:</p>
  <ol>
    <li>Gets the base vector for "Dog"</li>
    <li>Gets the base vector for "Animal"</li>
    <li>Applies the IS_A permutation to "Animal"</li>
    <li>Adds the permuted vector to "Dog" with saturation</li>
  </ol>

  <p>This produces a single point that represents the fact. See <a href="../architecture/geometry.html#relation-permuter">RelationPermuter</a> for implementation details.</p>

  <h2>Relation Properties</h2>

  <h3>Inverse Relations</h3>
  <p>Many relations have inverses. If A CAUSES B, then B CAUSED_BY A. Inverse relations use inverse permutations, so the encoding is consistent in both directions.</p>

  <h3>Symmetric Relations</h3>
  <p>Some relations are symmetric: SIMILAR_TO is the same in both directions. Symmetric relations reuse the same permutation for both subject and object roles.</p>

  <h3>Transitive Relations</h3>
  <p>Relations like IS_A support transitivity: if Dog IS_A Mammal and Mammal IS_A Animal, then Dog IS_A Animal. The <a href="../architecture/reasoning.html">Reasoner</a> handles transitivity through chain checking.</p>

  <h2>Built-in Relations</h2>

  <h3>Taxonomic Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Inverse</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>IS_A</code></td>
        <td><code>HAS_INSTANCE</code></td>
        <td>Type/class membership</td>
        <td>Dog IS_A Animal</td>
      </tr>
      <tr>
        <td><code>PART_OF</code></td>
        <td><code>HAS_PART</code></td>
        <td>Mereological containment</td>
        <td>Wheel PART_OF Car</td>
      </tr>
      <tr>
        <td><code>SUBCLASS_OF</code></td>
        <td><code>SUPERCLASS_OF</code></td>
        <td>Class hierarchy</td>
        <td>Mammal SUBCLASS_OF Animal</td>
      </tr>
    </tbody>
  </table>

  <h3>Causal Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Inverse</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>CAUSES</code></td>
        <td><code>CAUSED_BY</code></td>
        <td>Direct causation</td>
        <td>Fire CAUSES Smoke</td>
      </tr>
      <tr>
        <td><code>ENABLES</code></td>
        <td><code>ENABLED_BY</code></td>
        <td>Precondition</td>
        <td>Key ENABLES Door_Opening</td>
      </tr>
      <tr>
        <td><code>PREVENTS</code></td>
        <td><code>PREVENTED_BY</code></td>
        <td>Inhibition</td>
        <td>Vaccine PREVENTS Disease</td>
      </tr>
    </tbody>
  </table>

  <h3>Spatial Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Inverse</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>LOCATED_IN</code></td>
        <td><code>CONTAINS</code></td>
        <td>Spatial containment</td>
        <td>Paris LOCATED_IN France</td>
      </tr>
      <tr>
        <td><code>NEAR</code></td>
        <td><code>NEAR</code></td>
        <td>Proximity (symmetric)</td>
        <td>Library NEAR School</td>
      </tr>
      <tr>
        <td><code>ABOVE</code></td>
        <td><code>BELOW</code></td>
        <td>Vertical position</td>
        <td>Sky ABOVE Ground</td>
      </tr>
    </tbody>
  </table>

  <h3>Temporal Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Inverse</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>BEFORE</code></td>
        <td><code>AFTER</code></td>
        <td>Temporal ordering</td>
        <td>Monday BEFORE Tuesday</td>
      </tr>
      <tr>
        <td><code>DURING</code></td>
        <td><code>CONTAINS_TEMPORALLY</code></td>
        <td>Temporal containment</td>
        <td>Meeting DURING Morning</td>
      </tr>
      <tr>
        <td><code>OVERLAPS</code></td>
        <td><code>OVERLAPS</code></td>
        <td>Partial overlap (symmetric)</td>
        <td>Event1 OVERLAPS Event2</td>
      </tr>
    </tbody>
  </table>

  <h3>Deontic Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Inverse</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>PERMITS</code></td>
        <td><code>PERMITTED_BY</code></td>
        <td>Permission</td>
        <td>License PERMITS Driving</td>
      </tr>
      <tr>
        <td><code>PROHIBITS</code></td>
        <td><code>PROHIBITED_BY</code></td>
        <td>Prohibition</td>
        <td>Law PROHIBITS Theft</td>
      </tr>
      <tr>
        <td><code>OBLIGATES</code></td>
        <td><code>OBLIGATED_BY</code></td>
        <td>Obligation</td>
        <td>Contract OBLIGATES Payment</td>
      </tr>
      <tr>
        <td><code>REQUIRES</code></td>
        <td><code>REQUIRED_BY</code></td>
        <td>Requirement</td>
        <td>Driving REQUIRES License</td>
      </tr>
    </tbody>
  </table>

  <h3>Property Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>HAS_PROPERTY</code></td>
        <td>Attribute assignment</td>
        <td>Water HAS_PROPERTY liquid</td>
      </tr>
      <tr>
        <td><code>HAS_VALUE</code></td>
        <td>Numeric value</td>
        <td>Water HAS_VALUE temp=100</td>
      </tr>
      <tr>
        <td><code>HAS_ATTRIBUTE</code></td>
        <td>Named attribute</td>
        <td>Car HAS_ATTRIBUTE color=red</td>
      </tr>
    </tbody>
  </table>

  <h3>Similarity Relations</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Relation</th><th>Symmetric</th><th>Meaning</th><th>Example</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>SIMILAR_TO</code></td>
        <td>Yes</td>
        <td>General similarity</td>
        <td>Dog SIMILAR_TO Wolf</td>
      </tr>
      <tr>
        <td><code>DIFFERENT_FROM</code></td>
        <td>Yes</td>
        <td>Explicit distinction</td>
        <td>Cat DIFFERENT_FROM Dog</td>
      </tr>
    </tbody>
  </table>

  <h2>Custom Verbs</h2>

  <p>AGISystem2 supports defining custom relations beyond the built-in set. Custom verbs enable domain-specific knowledge representation.</p>

  <h3>Defining a Custom Verb</h3>

  <pre>
# In Sys2DSL
@_ TREATS DEFINE_RELATION inverse=TREATED_BY transitive=false

# Usage
@_ Aspirin TREATS Headache
@result ? TREATS Headache</pre>

  <h3>Custom Verb Properties</h3>

  <table class="table-concept-index">
    <thead>
      <tr><th>Property</th><th>Description</th><th>Default</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><code>inverse</code></td>
        <td>Name of inverse relation</td>
        <td>None (unidirectional)</td>
      </tr>
      <tr>
        <td><code>symmetric</code></td>
        <td>Same in both directions</td>
        <td>false</td>
      </tr>
      <tr>
        <td><code>transitive</code></td>
        <td>Chains apply (A→B→C means A→C)</td>
        <td>false</td>
      </tr>
      <tr>
        <td><code>permutation_seed</code></td>
        <td>Seed for deterministic permutation</td>
        <td>Hash of name</td>
      </tr>
    </tbody>
  </table>

  <h3>Domain Examples</h3>

  <pre>
# Medical domain
@_ TREATS DEFINE_RELATION inverse=TREATED_BY
@_ CONTRAINDICATED_WITH DEFINE_RELATION symmetric=true
@_ METABOLIZED_BY DEFINE_RELATION inverse=METABOLIZES

@_ Aspirin TREATS Pain
@_ Aspirin CONTRAINDICATED_WITH Warfarin
@_ Aspirin METABOLIZED_BY Liver

# Legal domain
@_ GOVERNS DEFINE_RELATION inverse=GOVERNED_BY
@_ SUPERSEDES DEFINE_RELATION inverse=SUPERSEDED_BY transitive=true

@_ GDPR GOVERNS DataProcessing
@_ Regulation_2023 SUPERSEDES Regulation_2020</pre>

  <h2>Natural Language Mapping</h2>

  <p>The <a href="../usage-cli/chat-cli.html">Chat Interface</a> maps natural language phrases to relations:</p>

  <table class="table-concept-index">
    <thead>
      <tr><th>Natural Language</th><th>Relation</th></tr>
    </thead>
    <tbody>
      <tr><td>"is a", "are", "is a type of"</td><td>IS_A</td></tr>
      <tr><td>"has", "contains", "includes"</td><td>HAS_PART</td></tr>
      <tr><td>"causes", "leads to", "results in"</td><td>CAUSES</td></tr>
      <tr><td>"is caused by", "comes from"</td><td>CAUSED_BY</td></tr>
      <tr><td>"is in", "located in"</td><td>LOCATED_IN</td></tr>
      <tr><td>"requires", "needs"</td><td>REQUIRES</td></tr>
      <tr><td>"allows", "permits"</td><td>PERMITS</td></tr>
      <tr><td>"prohibits", "forbids"</td><td>PROHIBITS</td></tr>
      <tr><td>"is before", "precedes"</td><td>BEFORE</td></tr>
      <tr><td>"is similar to", "is like"</td><td>SIMILAR_TO</td></tr>
    </tbody>
  </table>

  <h2>Geometric Interpretation</h2>

  <div class="diagram">
    <svg viewBox="0 0 480 200" role="img" aria-label="Different relations create different geometric patterns">
      <!-- IS_A: nested regions -->
      <rect x="20" y="20" width="130" height="160" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="30" y="40" font-size="9" font-weight="bold" fill="#0f4c81">IS_A (nested)</text>
      <rect x="35" y="55" width="100" height="100" rx="4" fill="#e1ecf7" fill-opacity="0.5" stroke="#0f4c81" stroke-width="1"/>
      <text x="45" y="70" font-size="8" fill="#0f4c81">Animal</text>
      <rect x="50" y="85" width="70" height="55" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="2"/>
      <text x="60" y="100" font-size="8" fill="#0f4c81">Mammal</text>
      <circle cx="85" cy="120" r="4" fill="#2e7d32"/>
      <text x="92" y="124" font-size="7" fill="#2e7d32">Dog</text>

      <!-- CAUSES: directional link -->
      <rect x="170" y="20" width="130" height="160" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="180" y="40" font-size="9" font-weight="bold" fill="#e65100">CAUSES (link)</text>
      <rect x="185" y="60" width="50" height="40" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="2"/>
      <text x="195" y="85" font-size="8" fill="#e65100">Fire</text>
      <rect x="185" y="120" width="50" height="40" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="2"/>
      <text x="192" y="145" font-size="8" fill="#e65100">Smoke</text>
      <line x1="210" y1="100" x2="210" y2="118" stroke="#e65100" stroke-width="2" marker-end="url(#arrow-rel)"/>

      <!-- SIMILAR_TO: proximity -->
      <rect x="320" y="20" width="140" height="160" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="330" y="40" font-size="9" font-weight="bold" fill="#2e7d32">SIMILAR_TO (proximity)</text>
      <circle cx="370" cy="100" r="5" fill="#2e7d32"/>
      <text x="380" y="105" font-size="8" fill="#2e7d32">Dog</text>
      <circle cx="420" cy="110" r="5" fill="#2e7d32"/>
      <text x="430" y="115" font-size="8" fill="#2e7d32">Wolf</text>
      <line x1="375" y1="100" x2="415" y2="108" stroke="#2e7d32" stroke-width="1" stroke-dasharray="3,2"/>
      <text x="385" y="95" font-size="7" fill="#4a5670">close</text>
    </svg>
    <p class="diagram-caption">Different relations create different geometric patterns. IS_A creates nested regions (subsets). CAUSES creates directional links between separate regions. SIMILAR_TO implies proximity in the space.</p>
  </div>

  <h2>Related Documentation</h2>

  <ul>
    <li><a href="../syntax/relations.html">Relations Syntax Reference</a> – Complete syntax for all relations</li>
    <li><a href="../syntax/custom_verbs.html">Custom Verbs Syntax</a> – Defining new relations</li>
    <li><a href="../architecture/geometry.html#relation-permuter">RelationPermuter</a> – How permutations are computed</li>
    <li><a href="../architecture/language.html#encoder">Fact Encoder</a> – Encoding process</li>
    <li><a href="../wiki/permutation_binding.html">Permutation Binding Wiki</a> – Background theory</li>
    <li><a href="reasoning.html">Reasoning</a> – How relations affect inference</li>
  </ul>

  <div class="footer-nav">
    <a href="conceptual_spaces.html">← Conceptual Spaces</a> ·
    <a href="reasoning.html">Reasoning →</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
