<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>API Reference</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>AGISystem2 – API Reference</h1>
    <small>
      <a href="../index.html">Home</a> ·
      <a href="../guides/conceptual_spaces.html">Theory</a> ·
      <a href="../architecture/index.html">Architecture</a> ·
      <a href="index.html">APIs</a> ·
      <a href="../syntax/index.html">Syntax</a> ·
      <a href="../usage-cli/index.html">CLI</a> ·
      <a href="../wiki/index.html">Wiki</a> ·
      <a href="../specs/matrix.html">Specs</a>
    </small>
  </div>

  <p>This page describes how to obtain a session and the methods it exposes. For command syntax, see <a href="../syntax/index.html">Syntax Reference</a>. For architecture details, see <a href="../architecture/index.html">Architecture</a>.</p>

  <h2>Creating a Session</h2>

  <pre>
const AgentSystem2 = require('agisystem2');

// Create agent with profile
const agent = new AgentSystem2({ profile: 'manual_test' });

// Create session
const session = agent.createSession();</pre>

  <h3>Configuration Profiles</h3>
  <table class="table-concept-index">
    <thead>
      <tr><th>Profile</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td><code>auto_test</code></td><td>Fast, low memory, for automated tests</td></tr>
      <tr><td><code>manual_test</code></td><td>Balanced, for development</td></tr>
      <tr><td><code>prod</code></td><td>High precision, for production</td></tr>
    </tbody>
  </table>

  <p>See <a href="../architecture/configuration.html">Configuration</a> for full parameter reference.</p>

  <h2>Session Methods</h2>

  <h3>run(commands)</h3>
  <p>Execute an array of Sys2DSL commands. Returns environment with bound variables.</p>

  <pre>
// Add facts
session.run(['@f Dog IS_A Animal']);
session.run(['@f Cat IS_A Animal']);

// Query
const env = session.run(['@q Dog IS_A Animal']);
console.log(env.q.truth);  // "TRUE_CERTAIN"

// Get matching facts
const matches = session.run(['@r ? IS_A Animal FACTS any']);
console.log(matches.r);  // [{ subject: 'Dog', relation: 'IS_A', object: 'Animal' }, ...]</pre>

  <h3>Theory Management</h3>
  <pre>
// Push new theory layer
session.run(['@_ experiment PUSH any']);

// Add facts to layer
session.run(['@f Water IS_A Solid']);  // Hypothetical

// Query in this context
const env = session.run(['@q Water IS_A Solid']);
console.log(env.q.truth);  // "TRUE_CERTAIN"

// Pop layer (discards facts)
session.run(['@_ any POP any']);

// Original state restored
const env2 = session.run(['@q Water IS_A Solid']);
console.log(env2.q.truth);  // "FALSE" or "UNKNOWN"</pre>

  <h3>Counterfactual Queries</h3>
  <pre>
// Ask "what if" questions
const env = session.run([
  '@cf CF "Is ice Water?" | Water TEMPERATURE_AT CelsiusMinus10'
]);
console.log(env.cf.truth);</pre>

  <h2>Common Patterns</h2>

  <h3>Load Theory File</h3>
  <pre>
session.run(['@_ medical_knowledge LOAD any']);</pre>

  <h3>Save Theory</h3>
  <pre>
session.run(['@_ my_session SAVE any']);</pre>

  <h3>List All Facts</h3>
  <pre>
const env = session.run(['@facts ? ? ? FACTS any']);
for (const fact of env.facts) {
  console.log(`${fact.subject} ${fact.relation} ${fact.object}`);
}</pre>

  <h2>Return Values</h2>

  <p>Query results include:</p>

  <table class="table-concept-index">
    <thead>
      <tr><th>Field</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td><code>truth</code></td><td><code>TRUE_CERTAIN</code>, <code>TRUE_PLAUSIBLE</code>, <code>FALSE</code>, <code>UNKNOWN</code></td></tr>
      <tr><td><code>confidence</code></td><td>Numeric confidence (0-1)</td></tr>
      <tr><td><code>trace</code></td><td>Provenance trace (optional)</td></tr>
    </tbody>
  </table>

  <h2>Related Documentation</h2>

  <ul>
    <li><a href="../syntax/index.html">Syntax Reference</a> – Command syntax details</li>
    <li><a href="../architecture/language.html">Language Layer</a> – How commands are processed</li>
    <li><a href="../usage-cli/index.html">CLI</a> – Command-line interface</li>
  </ul>

  <div class="footer-nav">
    <a href="../index.html">Home</a> ·
    <a href="../syntax/index.html">Syntax →</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
