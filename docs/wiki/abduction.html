<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Abduction</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>AGISystem2 – Abduction</h1>
    <small>
      <a href="../index.html">Home</a> ·
      <a href="../guides/conceptual_spaces.html">Theory</a> ·
      <a href="../architecture/index.html">Architecture</a> ·
      <a href="../api/index.html">APIs</a> ·
      <a href="../syntax/index.html">Syntax</a> ·
      <a href="../usage-cli/index.html">CLI</a> ·
      <a href="index.html">Wiki</a> ·
      <a href="../specs/matrix.html">Specs</a>
    </small>
  </div>

  <p>Abduction in AGISystem2 is reverse geometric search. Given an observation (effect), the system finds concepts that could explain it by searching backwards through relations. Instead of "X causes what?", abduction answers "what causes X?".</p>

  <div class="diagram">
    <svg viewBox="0 0 560 280" role="img" aria-label="Abduction as reverse search">
      <defs>
        <marker id="arrow-abd" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L6,3 L0,6 z" fill="#0f4c81" />
        </marker>
        <marker id="arrow-abd-rev" markerWidth="6" markerHeight="6" refX="1" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M6,0 L0,3 L6,6 z" fill="#e65100" />
        </marker>
      </defs>

      <!-- Background -->
      <rect x="0" y="0" width="560" height="280" fill="#fafbfc"/>

      <!-- Left: Forward (deduction) -->
      <rect x="20" y="20" width="160" height="100" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="100" y="40" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">Deduction (forward)</text>

      <rect x="35" y="55" width="50" height="30" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="1"/>
      <text x="60" y="74" font-size="9" fill="#0f4c81" text-anchor="middle">Fire</text>

      <line x1="87" y1="70" x2="113" y2="70" stroke="#0f4c81" stroke-width="1.5" marker-end="url(#arrow-abd)"/>
      <text x="100" y="62" font-size="7" fill="#4a5670" text-anchor="middle">CAUSES</text>

      <rect x="115" y="55" width="50" height="30" rx="4" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
      <text x="140" y="74" font-size="9" fill="#2e7d32" text-anchor="middle">Smoke</text>

      <text x="100" y="105" font-size="8" fill="#4a5670" text-anchor="middle">"Fire causes smoke"</text>

      <!-- Right: Backward (abduction) -->
      <rect x="200" y="20" width="160" height="100" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
      <text x="280" y="40" font-size="10" font-weight="bold" fill="#e65100" text-anchor="middle">Abduction (backward)</text>

      <rect x="215" y="55" width="50" height="30" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="2"/>
      <text x="240" y="74" font-size="9" fill="#e65100" text-anchor="middle">?</text>

      <line x1="293" y1="70" x2="267" y2="70" stroke="#e65100" stroke-width="1.5" marker-start="url(#arrow-abd-rev)"/>
      <text x="280" y="62" font-size="7" fill="#e65100" text-anchor="middle">CAUSES</text>

      <rect x="295" y="55" width="50" height="30" rx="4" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
      <text x="320" y="74" font-size="9" fill="#2e7d32" text-anchor="middle">Smoke</text>

      <text x="280" y="105" font-size="8" fill="#e65100" text-anchor="middle">"What causes smoke?"</text>

      <!-- Process flow -->
      <rect x="380" y="20" width="160" height="240" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="460" y="40" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">Abduction Process</text>

      <rect x="395" y="55" width="130" height="35" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="1"/>
      <text x="405" y="70" font-size="8" font-weight="bold" fill="#0f4c81">1. Encode observation</text>
      <text x="405" y="82" font-size="7" fill="#4a5670">v(Smoke) + π⁻¹(CAUSES)</text>

      <rect x="395" y="100" width="130" height="35" rx="4" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
      <text x="405" y="115" font-size="8" font-weight="bold" fill="#2e7d32">2. LSH candidate search</text>
      <text x="405" y="127" font-size="7" fill="#4a5670">Find nearby concepts</text>

      <rect x="395" y="145" width="130" height="35" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
      <text x="405" y="160" font-size="8" font-weight="bold" fill="#e65100">3. Rank by distance</text>
      <text x="405" y="172" font-size="7" fill="#4a5670">Fire: 0.12, Volcano: 0.45...</text>

      <rect x="395" y="190" width="130" height="55" rx="4" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
      <text x="405" y="205" font-size="8" font-weight="bold" fill="#2e7d32">Result:</text>
      <text x="405" y="220" font-size="8" fill="#4a5670">Fire (0.92 confidence)</text>
      <text x="405" y="235" font-size="8" fill="#4a5670">Volcano (0.45 confidence)</text>

      <!-- Bottom explanation -->
      <rect x="20" y="140" width="340" height="120" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="190" y="160" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">Inverse Permutation</text>

      <text x="35" y="180" font-size="9" fill="#4a5670">Forward: encode(Fire, CAUSES, Smoke) = v(Fire) + π(v(Smoke))</text>
      <text x="35" y="200" font-size="9" fill="#e65100">Abduction: Find X where v(X) ≈ queryVec - π⁻¹(v(Smoke))</text>
      <text x="35" y="225" font-size="8" fill="#4a5670">The inverse permutation π⁻¹ reverses the CAUSES encoding,</text>
      <text x="35" y="240" font-size="8" fill="#4a5670">letting us search for potential causes rather than effects.</text>
    </svg>
    <p class="diagram-caption">Abduction reverses the direction of inference. Instead of finding effects (deduction), it finds causes. The system uses the inverse permutation to encode the query backwards, then searches for concepts that match the reversed pattern.</p>
  </div>

  <h2>How It Works</h2>

  <p>The <a href="../architecture/reasoning.html">Reasoner</a> handles abductive queries by:</p>

  <ol>
    <li><strong>Apply inverse permutation</strong> – For "? CAUSES Smoke", use π⁻¹(CAUSES) to reverse the relation encoding</li>
    <li><strong>Build search vector</strong> – Create a query vector from the observation using the inverted permutation</li>
    <li><strong>LSH retrieval</strong> – Use <a href="lsh.html">LSH</a> to find candidate concepts near the query vector</li>
    <li><strong>Rank by distance</strong> – Score candidates by <a href="masked_l1_distance.html">masked L1 distance</a></li>
  </ol>

  <h2>Example Queries</h2>

  <pre>
# What causes smoke?
@result ? CAUSES Smoke
# → Fire (0.92), Volcano (0.45), Engine (0.38)

# What is located in France?
@result ? LOCATED_IN France
# → Paris (0.95), Lyon (0.88), Marseille (0.85)

# What treats headache?
@result ? TREATS Headache
# → Aspirin (0.91), Ibuprofen (0.87), Rest (0.65)</pre>

  <h2>Comparison with Deduction</h2>

  <table class="table-concept-index">
    <thead>
      <tr><th>Aspect</th><th>Deduction</th><th>Abduction</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Direction</td>
        <td>Premise → Conclusion</td>
        <td>Observation → Explanation</td>
      </tr>
      <tr>
        <td>Question</td>
        <td>"Does X follow from Y?"</td>
        <td>"What explains Y?"</td>
      </tr>
      <tr>
        <td>Permutation</td>
        <td>Forward π</td>
        <td>Inverse π⁻¹</td>
      </tr>
      <tr>
        <td>Certainty</td>
        <td>Guaranteed</td>
        <td>Probabilistic (multiple candidates)</td>
      </tr>
    </tbody>
  </table>

  <h2>Use Cases</h2>

  <ul>
    <li><strong>Diagnosis</strong> – Given symptoms, find possible diseases</li>
    <li><strong>Debugging</strong> – Given an error, find possible causes</li>
    <li><strong>Explanation</strong> – Given an observation, find reasons</li>
    <li><strong>Root cause analysis</strong> – Trace backwards through causal chains</li>
  </ul>

  <h2>Related Documentation</h2>

  <ul>
    <li><a href="../architecture/reasoning.html">Reasoner</a> – Query processing for abduction</li>
    <li><a href="permutation_binding.html">Permutation Binding</a> – How inverse permutations work</li>
    <li><a href="lsh.html">LSH</a> – Candidate retrieval for abductive search</li>
    <li><a href="deduction.html">Deduction</a> – Forward inference</li>
    <li><a href="induction.html">Induction</a> – Learning from examples</li>
  </ul>

  <div class="footer-nav">
    <a href="induction.html">← Induction</a> ·
    <a href="analogy.html">Analogy →</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
