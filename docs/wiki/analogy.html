<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Analogy</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>AGISystem2 – Analogy</h1>
    <small>
      <a href="../index.html">Home</a> ·
      <a href="../guides/conceptual_spaces.html">Theory</a> ·
      <a href="../architecture/index.html">Architecture</a> ·
      <a href="../api/index.html">APIs</a> ·
      <a href="../syntax/index.html">Syntax</a> ·
      <a href="../usage-cli/index.html">CLI</a> ·
      <a href="index.html">Wiki</a> ·
      <a href="../specs/matrix.html">Specs</a>
    </small>
  </div>

  <p>Analogy in AGISystem2 is geometric translation. If "king" is to "queen" as "man" is to "?", the answer comes from computing the offset between king and queen, then applying it to man. This transforms relational reasoning into vector arithmetic.</p>

  <div class="diagram">
    <svg viewBox="0 0 560 300" role="img" aria-label="Analogy as vector offset">
      <defs>
        <marker id="arrow-ana" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L6,3 L0,6 z" fill="#0f4c81" />
        </marker>
        <marker id="arrow-ana-orange" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L6,3 L0,6 z" fill="#e65100" />
        </marker>
      </defs>

      <!-- Background -->
      <rect x="0" y="0" width="560" height="300" fill="#fafbfc"/>

      <!-- 2D space visualization -->
      <rect x="20" y="20" width="280" height="260" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="160" y="40" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">Conceptual Space (2D projection)</text>

      <!-- Axes labels -->
      <text x="290" y="270" font-size="8" fill="#4a5670">gender →</text>
      <text x="30" y="55" font-size="8" fill="#4a5670" transform="rotate(-90, 30, 55)">royalty →</text>

      <!-- Points -->
      <circle cx="100" cy="200" r="8" fill="#0f4c81"/>
      <text x="100" y="225" font-size="10" fill="#0f4c81" text-anchor="middle">man</text>

      <circle cx="220" cy="200" r="8" fill="#2e7d32"/>
      <text x="220" y="225" font-size="10" fill="#2e7d32" text-anchor="middle">woman</text>

      <circle cx="100" cy="80" r="8" fill="#0f4c81"/>
      <text x="100" y="70" font-size="10" fill="#0f4c81" text-anchor="middle">king</text>

      <circle cx="220" cy="80" r="8" fill="#2e7d32"/>
      <text x="220" y="70" font-size="10" fill="#2e7d32" text-anchor="middle">queen</text>

      <!-- Offset arrows -->
      <line x1="100" y1="80" x2="215" y2="80" stroke="#e65100" stroke-width="2" marker-end="url(#arrow-ana-orange)"/>
      <text x="157" y="70" font-size="9" fill="#e65100" text-anchor="middle">offset</text>

      <line x1="100" y1="200" x2="215" y2="200" stroke="#e65100" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrow-ana-orange)"/>
      <text x="157" y="215" font-size="9" fill="#e65100" text-anchor="middle">apply offset</text>

      <!-- Question mark at target -->
      <circle cx="220" cy="200" r="12" fill="none" stroke="#e65100" stroke-width="2" stroke-dasharray="3,2"/>

      <!-- Formula panel -->
      <rect x="320" y="20" width="220" height="120" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="430" y="40" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">Analogy Formula</text>

      <text x="335" y="65" font-size="10" fill="#0f4c81">A : B :: C : ?</text>
      <text x="335" y="85" font-size="10" fill="#4a5670">offset = v(B) - v(A)</text>
      <text x="335" y="105" font-size="10" fill="#e65100">? = v(C) + offset</text>
      <text x="335" y="125" font-size="9" fill="#4a5670">= v(C) + v(B) - v(A)</text>

      <!-- Example panel -->
      <rect x="320" y="155" width="220" height="125" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
      <text x="430" y="175" font-size="10" font-weight="bold" fill="#e65100" text-anchor="middle">Example</text>

      <text x="335" y="200" font-size="9" fill="#4a5670">king : queen :: man : ?</text>
      <text x="335" y="220" font-size="9" fill="#4a5670">offset = v(queen) - v(king)</text>
      <text x="335" y="240" font-size="9" fill="#4a5670">? = v(man) + offset</text>
      <text x="335" y="260" font-size="10" fill="#2e7d32" font-weight="bold">→ woman (nearest match)</text>
    </svg>
    <p class="diagram-caption">Analogy computes an offset from A to B, then applies the same offset to C to find D. In conceptual space, "king→queen" and "man→woman" share the same gender-direction offset. The answer is the concept nearest to the computed target point.</p>
  </div>

  <h2>How It Works</h2>

  <p>The <a href="../architecture/reasoning.html">Reasoner</a> handles analogy queries in three steps:</p>

  <ol>
    <li><strong>Compute offset</strong> – Calculate v(B) - v(A) to get the relational difference</li>
    <li><strong>Apply to source</strong> – Add offset to v(C) to get target vector</li>
    <li><strong>Find nearest</strong> – Use <a href="lsh.html">LSH</a> to find the concept closest to the target</li>
  </ol>

  <p>This works because similar relations produce similar offsets across different concept pairs. The "male→female" offset is approximately the same whether applied to king/queen, man/woman, or actor/actress.</p>

  <h2>Sys2DSL Syntax</h2>

  <pre>
# Basic analogy
ANALOGY king:queen :: man:?
# → woman

# With explicit relation
ANALOGY Paris:France :: Berlin:?
# → Germany (LOCATED_IN relation)

# Multi-step
ANALOGY doctor:hospital :: teacher:?
# → school (WORKS_AT relation)</pre>

  <h2>Masked Analogy</h2>

  <p>Analogies can use <a href="masked_l1_distance.html">masks</a> to focus on specific dimensions:</p>

  <table class="table-concept-index">
    <thead>
      <tr><th>Mask Type</th><th>Effect</th><th>Use Case</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Full mask</td>
        <td>All dimensions contribute</td>
        <td>General analogies</td>
      </tr>
      <tr>
        <td>Ontology only</td>
        <td>Factual dimensions only</td>
        <td>Scientific analogies</td>
      </tr>
      <tr>
        <td>Custom domain</td>
        <td>Specific dimension subset</td>
        <td>Domain-specific transfer</td>
      </tr>
    </tbody>
  </table>

  <h2>Quality Metrics</h2>

  <p>Analogy results include confidence scores based on:</p>
  <ul>
    <li><strong>Distance to target</strong> – How close is the answer to the computed point?</li>
    <li><strong>Offset consistency</strong> – Does the same offset work for other known pairs?</li>
    <li><strong>Relation preservation</strong> – Does the answer maintain the implicit relation type?</li>
  </ul>

  <h2>Related Documentation</h2>

  <ul>
    <li><a href="../architecture/reasoning.html">Reasoner</a> – Analogy computation</li>
    <li><a href="lsh.html">LSH</a> – Finding nearest concepts</li>
    <li><a href="../guides/conceptual_spaces.html">Conceptual Spaces</a> – Why vector arithmetic captures relations</li>
    <li><a href="deduction.html">Deduction</a> – Containment-based inference</li>
    <li><a href="induction.html">Induction</a> – Learning concept boundaries</li>
  </ul>

  <div class="footer-nav">
    <a href="abduction.html">← Abduction</a> ·
    <a href="counterfactual.html">Counterfactuals →</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
