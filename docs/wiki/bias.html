<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Bias Control</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>AGISystem2 – Bias Control</h1>
    <small>
      <a href="../index.html">Home</a> ·
      <a href="../guides/conceptual_spaces.html">Theory</a> ·
      <a href="../architecture/index.html">Architecture</a> ·
      <a href="../api/index.html">APIs</a> ·
      <a href="../syntax/index.html">Syntax</a> ·
      <a href="../usage-cli/index.html">CLI</a> ·
      <a href="index.html">Wiki</a> ·
      <a href="../specs/matrix.html">Specs</a>
    </small>
  </div>

  <p>Bias control in AGISystem2 uses dimension masking to prevent protected attributes from influencing decisions. The <a href="../architecture/reasoning.html#bias-controller">BiasController</a> can selectively disable dimensions during reasoning, implementing a geometric "<a href="veil_of_ignorance.html">veil of ignorance</a>".</p>

  <div class="diagram">
    <svg viewBox="0 0 560 340" role="img" aria-label="Bias mask dimension bands">
      <defs>
        <marker id="arrow-bias" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L6,3 L0,6 z" fill="#0f4c81" />
        </marker>
      </defs>

      <!-- Background -->
      <rect x="0" y="0" width="560" height="340" fill="#fafbfc"/>

      <!-- Full vector -->
      <rect x="20" y="20" width="520" height="60" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="280" y="40" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">384-Dimensional Concept Vector</text>

      <!-- Dimension bands -->
      <rect x="40" y="50" width="200" height="20" rx="2" fill="#e1ecf7" stroke="#0f4c81" stroke-width="1"/>
      <text x="140" y="64" font-size="8" fill="#0f4c81" text-anchor="middle">Ontology: 0-255</text>

      <rect x="240" y="50" width="80" height="20" rx="2" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
      <text x="280" y="64" font-size="8" fill="#c62828" text-anchor="middle">Protected</text>

      <rect x="320" y="50" width="180" height="20" rx="2" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
      <text x="410" y="64" font-size="8" fill="#e65100" text-anchor="middle">Axiology: 256-383</text>

      <!-- Mask application -->
      <rect x="20" y="100" width="250" height="120" rx="4" fill="#f5f7fb" stroke="#b0b6c4" stroke-width="1"/>
      <text x="145" y="120" font-size="10" font-weight="bold" fill="#4a5670" text-anchor="middle">Bias Mask Application</text>

      <!-- Original vector -->
      <text x="35" y="145" font-size="9" fill="#4a5670">Original vector:</text>
      <rect x="35" y="150" width="220" height="15" rx="2" fill="#e1ecf7" stroke="#0f4c81" stroke-width="1"/>
      <text x="70" y="161" font-size="7" fill="#0f4c81">ontology</text>
      <rect x="120" y="150" width="40" height="15" fill="#ffebee" stroke="#c62828" stroke-width="1"/>
      <text x="140" y="161" font-size="7" fill="#c62828" text-anchor="middle">prot</text>
      <rect x="160" y="150" width="95" height="15" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
      <text x="207" y="161" font-size="7" fill="#e65100" text-anchor="middle">axiology</text>

      <!-- Mask -->
      <text x="35" y="180" font-size="9" fill="#4a5670">Bias mask:</text>
      <rect x="35" y="185" width="220" height="15" rx="2" fill="#fff" stroke="#b0b6c4" stroke-width="1"/>
      <text x="70" y="196" font-size="7" fill="#2e7d32">1 1 1 1</text>
      <rect x="120" y="185" width="40" height="15" fill="#ffebee" stroke="#c62828" stroke-width="1"/>
      <text x="140" y="196" font-size="7" fill="#c62828" text-anchor="middle">0 0</text>
      <text x="207" y="196" font-size="7" fill="#2e7d32" text-anchor="middle">1 1 1 1</text>

      <!-- Result -->
      <text x="35" y="210" font-size="9" fill="#4a5670">Masked result:</text>
      <rect x="35" y="215" width="80" height="15" rx="2" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
      <rect x="120" y="215" width="40" height="15" fill="#f5f5f5" stroke="#b0b6c4" stroke-width="1" stroke-dasharray="3,2"/>
      <text x="140" y="226" font-size="7" fill="#b0b6c4" text-anchor="middle">×</text>
      <rect x="160" y="215" width="95" height="15" rx="2" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>

      <!-- BiasController operations -->
      <rect x="290" y="100" width="250" height="120" rx="4" fill="#e1ecf7" stroke="#0f4c81" stroke-width="1"/>
      <text x="415" y="120" font-size="10" font-weight="bold" fill="#0f4c81" text-anchor="middle">BiasController Operations</text>

      <text x="305" y="145" font-size="9" font-family="monospace" fill="#0f4c81">setProtectedDimensions([120-159])</text>
      <text x="305" y="165" font-size="8" fill="#4a5670">Marks dimensions as protected</text>

      <text x="305" y="190" font-size="9" font-family="monospace" fill="#0f4c81">maskedDistance(a, b)</text>
      <text x="305" y="210" font-size="8" fill="#4a5670">L1 distance ignoring protected dims</text>

      <!-- Use cases -->
      <rect x="20" y="235" width="520" height="90" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
      <text x="280" y="255" font-size="10" font-weight="bold" fill="#e65100" text-anchor="middle">Protected Dimension Examples</text>

      <rect x="35" y="270" width="150" height="45" rx="4" fill="#fff" stroke="#e65100" stroke-width="1"/>
      <text x="110" y="288" font-size="9" font-weight="bold" fill="#e65100" text-anchor="middle">Employment</text>
      <text x="110" y="303" font-size="8" fill="#4a5670" text-anchor="middle">Age, gender, ethnicity</text>

      <rect x="200" y="270" width="150" height="45" rx="4" fill="#fff" stroke="#e65100" stroke-width="1"/>
      <text x="275" y="288" font-size="9" font-weight="bold" fill="#e65100" text-anchor="middle">Lending</text>
      <text x="275" y="303" font-size="8" fill="#4a5670" text-anchor="middle">Race, zip code proxies</text>

      <rect x="365" y="270" width="160" height="45" rx="4" fill="#fff" stroke="#e65100" stroke-width="1"/>
      <text x="445" y="288" font-size="9" font-weight="bold" fill="#e65100" text-anchor="middle">Scientific reasoning</text>
      <text x="445" y="303" font-size="8" fill="#4a5670" text-anchor="middle">All axiological dims masked</text>
    </svg>
    <p class="diagram-caption">The BiasController applies dimension masks to prevent protected attributes from influencing reasoning. When a mask has 0 in a dimension, that dimension is ignored during distance calculations. This implements fair decision-making by making the system "blind" to sensitive attributes.</p>
  </div>

  <h2>How It Works</h2>

  <p>Bias control operates by modifying the <a href="masked_l1_distance.html">masked L1 distance</a> calculation:</p>

  <ol>
    <li><strong>Define protected dimensions</strong> – Specify which dimensions encode sensitive attributes</li>
    <li><strong>Create mask</strong> – Set protected dimension weights to 0</li>
    <li><strong>Apply during reasoning</strong> – All similarity and containment checks use the masked distance</li>
    <li><strong>Log decisions</strong> – <a href="auditability.html">AuditLog</a> records when bias masks were applied</li>
  </ol>

  <h2>Mask Types</h2>

  <table class="table-concept-index">
    <thead>
      <tr><th>Mask Type</th><th>Dimensions Masked</th><th>Use Case</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Ontology-only</td>
        <td>256-383 (all axiology)</td>
        <td>Pure factual reasoning</td>
      </tr>
      <tr>
        <td>Protected attributes</td>
        <td>Specific ontological dims</td>
        <td>Fair hiring, lending</td>
      </tr>
      <tr>
        <td>Custom domain</td>
        <td>Domain-specific subset</td>
        <td>Medical, legal contexts</td>
      </tr>
      <tr>
        <td>Full mask</td>
        <td>None (all dims active)</td>
        <td>Normal reasoning</td>
      </tr>
    </tbody>
  </table>

  <h2>Implementation</h2>

  <pre>
// Define protected dimensions
biasController.setProtectedDimensions([120, 121, 122, 123]); // e.g., age, gender

// Create mask (384 dims, 1 = active, 0 = masked)
const mask = biasController.createFairnessMask();
// Result: [1,1,...,1,0,0,0,0,1,1,...] with 0s at positions 120-123

// Use in reasoning
const fairDistance = mathEngine.maskedL1(conceptA, conceptB, mask);

// Audit log entry created automatically:
// { action: "BIAS_MASK_APPLIED", dims: [120-123], context: "employment_decision" }</pre>

  <h2>Veil of Ignorance Mode</h2>

  <p>For maximum fairness, enable veil of ignorance mode which masks all axiological dimensions plus protected ontological ones:</p>

  <pre>
// Full veil: no values, no protected attributes
biasController.enableVeilOfIgnorance({
  protectedOntology: [120, 121, 122, 123],
  includeAllAxiology: true
});

// Now all reasoning ignores both values and protected attributes
ASK "Should applicant be hired?" # Based only on qualifications</pre>

  <h2>Bias Detection</h2>

  <p>The system can detect potential bias by comparing results with and without masks:</p>

  <pre>
// Run query twice: with and without mask
const normalResult = reasoner.ask(query, { mask: fullMask });
const fairResult = reasoner.ask(query, { mask: fairnessMask });

// If results differ, bias may be present
if (normalResult !== fairResult) {
  auditLog.warn("BIAS_DETECTED", { query, diff: [...] });
}</pre>

  <h2>Related Documentation</h2>

  <ul>
    <li><a href="../architecture/reasoning.html#bias-controller">BiasController</a> – Implementation details</li>
    <li><a href="veil_of_ignorance.html">Veil of Ignorance</a> – Full fairness mode</li>
    <li><a href="axiology.html">Axiology</a> – Value dimensions (often masked)</li>
    <li><a href="ontology.html">Ontology</a> – Factual dimensions (selectively masked)</li>
    <li><a href="auditability.html">Auditability</a> – Logging bias control decisions</li>
    <li><a href="masked_l1_distance.html">Masked L1 Distance</a> – The underlying metric</li>
  </ul>

  <div class="footer-nav">
    <a href="axiology.html">← Axiology</a> ·
    <a href="veil_of_ignorance.html">Veil of Ignorance →</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
