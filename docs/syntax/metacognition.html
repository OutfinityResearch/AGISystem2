<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Metacognition – Sys2DSL</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>System Metacognition</h1>
    <div class="sub-nav">
      <strong>Syntax Topics:</strong>
      <a href="syntax_scripts.html">Sys2DSL</a> ·
      <a href="dimensions.html">Dimensions</a> ·
      <a href="relations.html">Relations</a> ·
      <a href="custom_verbs.html">Custom Verbs</a> ·
      <a href="metacognition.html">Metacognition</a>
    </div>
  </div>

  <article>
    <div class="philosophical-introduction">
      <p><strong>Metacognition</strong> is the system's ability to reason about <em>its own knowledge and reasoning processes</em>. AGISystem2 exposes this internal structure through Sys2DSL commands, allowing explicit introspection, self-monitoring, and adaptive behavior.</p>
    </div>

    <h2>Overview: How It All Connects</h2>

    <div class="diagram">
      <pre>
┌─────────────────────────────────────────────────────────────────┐
│                      Sys2DSL Script                             │
│  @var COMMAND subject VERB complement                           │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                    DSL Engine (dsl_engine.js)                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │   Parser     │─▶│  Topological │─▶│   Command    │          │
│  │              │  │    Sorter    │  │   Executor   │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└───────────────────────────┬─────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        ▼                   ▼                   ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│ Concept Store │   │ Theory Stack  │   │   Reasoner    │
│ (knowledge)   │   │ (layers)      │   │ (inference)   │
└───────┬───────┘   └───────┬───────┘   └───────┬───────┘
        │                   │                   │
        ▼                   ▼                   ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Vector Space (1024 dims)                     │
│  ┌─────────────────────┐  ┌─────────────────────────────────┐  │
│  │  Ontology (0-255)   │  │  Axiology (256-383) + Extended  │  │
│  │  Facts, categories  │  │  Values, norms, context         │  │
│  └─────────────────────┘  └─────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
      </pre>
    </div>

    <h2>1. Knowledge Layer: Concept Store</h2>
    <p>The Concept Store maintains all known concepts, facts, and their relationships.</p>

    <h3>Introspection Commands</h3>
    <table class="table-concept-index">
      <tr>
        <th>Command</th>
        <th>Purpose</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>FACTS_MATCHING</code></td>
        <td>Query facts by pattern</td>
        <td><code>@facts FACTS_MATCHING Dog ? ?</code></td>
      </tr>
      <tr>
        <td><code>GET_USAGE</code></td>
        <td>Usage statistics for a concept</td>
        <td><code>@stats GET_USAGE Water</code></td>
      </tr>
      <tr>
        <td><code>LIST_CONCEPTS</code></td>
        <td>All known concepts</td>
        <td><code>@all LIST_CONCEPTS</code></td>
      </tr>
      <tr>
        <td><code>COUNT</code></td>
        <td>Count items in a list</td>
        <td><code>@n COUNT $facts</code></td>
      </tr>
    </table>

    <h3>Example: Self-Assessment of Knowledge</h3>
    <pre><code># How much do we know about animals?
@animalFacts any FACTS animal
@animalCount $animalFacts COUNT any

# What concepts are most used?
@dogUsage Dog GET_USAGE any
@catUsage Cat GET_USAGE any

# Check knowledge coverage
@hasTemperature any FACTS any
@text $hasTemperature TO_NATURAL any</code></pre>

    <h2>2. Theory Layer: Context Management</h2>
    <p>The Theory Stack enables hypothetical reasoning and context switching.</p>

    <h3>Theory Commands</h3>
    <table class="table-concept-index">
      <tr>
        <th>Command</th>
        <th>Purpose</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>PUSH</code></td>
        <td>Create new hypothetical layer</td>
        <td><code>@_ exploration PUSH any</code></td>
      </tr>
      <tr>
        <td><code>POP</code></td>
        <td>Discard hypothetical layer</td>
        <td><code>@_ any POP any</code></td>
      </tr>
      <tr>
        <td><code>THEORIES</code></td>
        <td>Show theory stack</td>
        <td><code>@stack any THEORIES any</code></td>
      </tr>
      <tr>
        <td><code>LOAD</code></td>
        <td>Load saved theory</td>
        <td><code>@_ physics LOAD any</code></td>
      </tr>
      <tr>
        <td><code>SAVE</code></td>
        <td>Save current layer</td>
        <td><code>@_ myDomain SAVE any</code></td>
      </tr>
    </table>

    <h3>Example: What-If Exploration</h3>
    <pre><code># Base knowledge
@_ Ice IS_A solid
@_ Water IS_A liquid

# Explore hypothetical: what if ice was a liquid?
@_ hypothetical_ice PUSH any
@_ Ice IS_A liquid

# Query in this context
@q1 Ice IS_A solid  # FALSE in this layer

# Check theory stack
@stack any THEORIES any
# Returns: ["base", "hypothetical_ice"]

# Discard hypothetical
@_ any POP any

# Back to base
@q2 Ice IS_A solid  # TRUE again</code></pre>

    <h2>3. Reasoning Layer: Inference Introspection</h2>
    <p>Understand <em>how</em> conclusions are reached, not just <em>what</em> they are.</p>

    <h3>Reasoning Commands</h3>
    <table class="table-concept-index">
      <tr>
        <th>Command</th>
        <th>Purpose</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>PROVE</code></td>
        <td>Find proof chain</td>
        <td><code>@proof PROVE Dog IS_A animal</code></td>
      </tr>
      <tr>
        <td><code>EXPLAIN</code></td>
        <td>Human-readable explanation</td>
        <td><code>@exp EXPLAIN $proof</code></td>
      </tr>
      <tr>
        <td><code>ABDUCT</code></td>
        <td>Find possible causes</td>
        <td><code>@causes ABDUCT Smoke CAUSED_BY</code></td>
      </tr>
      <tr>
        <td><code>HYPOTHESIZE</code></td>
        <td>Generate hypotheses</td>
        <td><code>@hyp HYPOTHESIZE Symptom</code></td>
      </tr>
      <tr>
        <td><code>VALIDATE</code></td>
        <td>Check consistency</td>
        <td><code>@valid VALIDATE</code></td>
      </tr>
      <tr>
        <td><code>INFER</code></td>
        <td>Query with full inference</td>
        <td><code>@result INFER Dog IS_A animal</code></td>
      </tr>
      <tr>
        <td><code>FORWARD_CHAIN</code></td>
        <td>Derive all conclusions</td>
        <td><code>@derived FORWARD_CHAIN</code></td>
      </tr>
      <tr>
        <td><code>WHY</code></td>
        <td>Explain how a fact was derived</td>
        <td><code>@exp WHY Dog IS_A animal</code></td>
      </tr>
    </table>

    <h3>Example: Explanation Chain</h3>
    <pre><code># Establish knowledge
@_ Dog IS_A mammal
@_ mammal IS_A animal

# Prove a transitive conclusion
@proof Dog PROVE animal

# Get human-readable explanation
@explanation $proof EXPLAIN any
# Returns: "Dog IS_A animal because:
#   1. Dog IS_A mammal (direct fact)
#   2. mammal IS_A animal (direct fact)
#   3. IS_A is transitive, so Dog IS_A animal"</code></pre>

    <h3>Example: Full Inference with Forward Chaining</h3>
    <pre><code># Establish knowledge with inference rules
@_ Dog IS_A mammal
@_ mammal IS_A animal
@_ animal HAS_PROPERTY needs_food

# Define a custom inference rule
@r1 inheritance DEFINE_RULE any

# Forward chain to derive all conclusions
@derived any FORWARD_CHAIN any

# Query derived facts
@result Dog HAS_PROPERTY needs_food
# Returns: { truth: "TRUE_INFERRED", method: "inheritance", chain: [...] }

# Understand why
@why Dog WHY needs_food</code></pre>

    <h2>3.1 Contradiction Detection: Knowledge Consistency</h2>
    <p>The system actively monitors for logical contradictions and can prevent inconsistent facts from being added.</p>

    <h3>Contradiction Types</h3>
    <table class="table-concept-index">
      <tr>
        <th>Type</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>DISJOINT_VIOLATION</code></td>
        <td>Entity belongs to mutually exclusive types</td>
        <td>Fluffy IS_A Cat AND Fluffy IS_A Dog (when Cat DISJOINT_WITH Dog)</td>
      </tr>
      <tr>
        <td><code>FUNCTIONAL_VIOLATION</code></td>
        <td>Multiple values for a functional relation</td>
        <td>Alice BORN_IN Paris AND Alice BORN_IN London</td>
      </tr>
      <tr>
        <td><code>TAXONOMIC_CYCLE</code></td>
        <td>Circular inheritance</td>
        <td>A IS_A B, B IS_A C, C IS_A A</td>
      </tr>
      <tr>
        <td><code>CARDINALITY_VIOLATION</code></td>
        <td>Too many/few relations</td>
        <td>Person with 3 biological parents (max is 2)</td>
      </tr>
    </table>

    <h3>Contradiction Commands</h3>
    <table class="table-concept-index">
      <tr>
        <th>Command</th>
        <th>Purpose</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>CHECK_CONTRADICTION</code></td>
        <td>Check all facts for contradictions</td>
        <td><code>@report CHECK_CONTRADICTION</code></td>
      </tr>
      <tr>
        <td><code>CHECK_WOULD_CONTRADICT</code></td>
        <td>Test if adding a fact would create contradiction</td>
        <td><code>@test CHECK_WOULD_CONTRADICT Fluffy IS_A Dog</code></td>
      </tr>
      <tr>
        <td><code>REGISTER_FUNCTIONAL</code></td>
        <td>Declare a relation as functional (one value only)</td>
        <td><code>@_ REGISTER_FUNCTIONAL BORN_IN</code></td>
      </tr>
      <tr>
        <td><code>REGISTER_CARDINALITY</code></td>
        <td>Set min/max constraints on a relation</td>
        <td><code>@_ REGISTER_CARDINALITY Person HAS_PARENT 0 2</code></td>
      </tr>
    </table>

    <h3>Example: Consistency Checking</h3>
    <pre><code># Establish type disjointness
@_ Cat DISJOINT_WITH Dog
@_ mammal DISJOINT_WITH reptile

# Add some facts
@_ Fluffy IS_A Cat
@_ Rex IS_A Dog

# Check consistency
@report any CHECK_CONTRADICTION any
# Returns: { consistent: true, contradictions: [] }

# Test hypothetical addition
@test Fluffy IS_A Dog
# Returns: { wouldContradict: true, reason: "DISJOINT_VIOLATION",
#            details: "Fluffy cannot be both Cat and Dog" }

# Set up functional constraints
@_ BORN_IN REGISTER_FUNCTIONAL any

# This would be flagged:
@_ Alice BORN_IN Paris
@_ Alice BORN_IN London  # WARNING: functional violation

# Check again
@report2 any CHECK_CONTRADICTION any
# Returns: { consistent: false, contradictions: [
#   { type: "FUNCTIONAL_VIOLATION", subject: "Alice", relation: "BORN_IN", values: ["Paris", "London"] }
# ]}</code></pre>

    <h2>4. Memory Management: Self-Optimization</h2>
    <p>The system tracks usage and can selectively forget low-value knowledge.</p>

    <h3>Memory Commands</h3>
    <table class="table-concept-index">
      <tr>
        <th>Command</th>
        <th>Purpose</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>GET_USAGE</code></td>
        <td>Usage statistics</td>
        <td><code>@stats GET_USAGE concept</code></td>
      </tr>
      <tr>
        <td><code>PROTECT</code></td>
        <td>Mark as unforgettable</td>
        <td><code>@_ PROTECT CoreConcept</code></td>
      </tr>
      <tr>
        <td><code>UNPROTECT</code></td>
        <td>Allow forgetting</td>
        <td><code>@_ UNPROTECT TempConcept</code></td>
      </tr>
      <tr>
        <td><code>FORGET</code></td>
        <td>Remove low-usage concepts</td>
        <td><code>@_ FORGET threshold=5</code></td>
      </tr>
      <tr>
        <td><code>BOOST</code></td>
        <td>Increase priority</td>
        <td><code>@_ BOOST ImportantConcept 50</code></td>
      </tr>
    </table>

    <h3>Example: Memory Maintenance</h3>
    <pre><code># Check what's rarely used
@lowUsage FACTS_MATCHING ? usage_count LessThan 3

# Protect critical concepts
@_ PROTECT Water
@_ PROTECT fundamental_axiom

# Boost important domain concepts
@_ BOOST CustomerData 100

# Clean up (dry run first)
@preview FORGET threshold=5 dryRun=true

# Actually forget
@result FORGET threshold=5</code></pre>

    <h2>5. Dimension Masks: Attention Focus</h2>
    <p>Masks control which dimensions participate in reasoning – a form of selective attention.</p>

    <h3>Mask Commands</h3>
    <table class="table-concept-index">
      <tr>
        <th>Command</th>
        <th>Purpose</th>
        <th>Example</th>
      </tr>
      <tr>
        <td><code>MASK_PARTITIONS</code></td>
        <td>Mask by partition</td>
        <td><code>@m MASK_PARTITIONS ontology</code></td>
      </tr>
      <tr>
        <td><code>MASK_DIMS</code></td>
        <td>Mask specific dims</td>
        <td><code>@m MASK_DIMS temperature color</code></td>
      </tr>
      <tr>
        <td><code>MASK_CONCEPT</code></td>
        <td>Mask by concept relevance</td>
        <td><code>@m MASK_CONCEPT $waterRef</code></td>
      </tr>
      <tr>
        <td><code>ASK_MASKED</code></td>
        <td>Query with mask</td>
        <td><code>@q Water IS_A liquid</code></td>
      </tr>
    </table>

    <h3>Example: Bias Control</h3>
    <pre><code># Create mask that ignores value judgments
@fairMask ontology MASK_PARTITIONS any

# Query without axiological bias
@result Candidate ASK Position

# Compare with full query
@fullResult Candidate ASK Position

# Explain the difference
@diff $result EXPLAIN_DIFFERENCE $fullResult</code></pre>

    <h2>6. Relation Introspection</h2>
    <p>Query and understand the relation system itself.</p>

    <h3>Relation Introspection Commands</h3>
    <pre><code># List all known relations
@rels LIST_RELATIONS

# Get properties of a relation
@info GET_RELATION_INFO IS_A
# Returns: { symmetric: false, transitive: true, inverse: null }

# Find relations between concepts
@links GET_RELATIONS_BETWEEN Dog mammal
# Returns: ["IS_A"]</code></pre>

    <h2>7. Script Evaluation: Understanding Execution</h2>
    <p>The DSL engine itself can be introspected.</p>

    <h3>Evaluation Model</h3>
    <p>Scripts are evaluated in <strong>topological order</strong> based on variable dependencies:</p>

    <pre><code># These can appear in any order in the file
@b BOOL_AND $a $a    # Depends on @a
@a NONEMPTY $list    # Depends on @list
@list FACTS_MATCHING dog IS_A ?  # No dependencies

# Execution order:
# 1. @list (no deps)
# 2. @a (depends on @list)
# 3. @b (depends on @a)</code></pre>

    <h3>Variable Composition</h3>
    <p>Variables enable metacognitive composition:</p>

    <pre><code># Store a concept reference
@subject BIND_CONCEPT Water
@relation BIND_RELATION BOILS_AT
@value BIND_CONCEPT Celsius100

# Compose dynamically
@fact $subject $relation $value

# The system "knows" it asserted Water BOILS_AT Celsius100
@reflection GET_LAST_ASSERTION
# Returns: { subject: "Water", relation: "BOILS_AT", object: "Celsius100" }</code></pre>

    <h2>8. The Four Use Cases of Sys2DSL</h2>
    <p>Understanding the system's metacognitive purpose:</p>

    <table class="table-concept-index">
      <tr>
        <th>Use Case</th>
        <th>Primary Commands</th>
        <th>Metacognitive Purpose</th>
      </tr>
      <tr>
        <td><strong>Define Theory</strong></td>
        <td>ASSERT, DEFINE_RELATION</td>
        <td>Building the knowledge base</td>
      </tr>
      <tr>
        <td><strong>Validate</strong></td>
        <td>VALIDATE, ALL_REQUIREMENTS_SATISFIED</td>
        <td>Self-checking consistency</td>
      </tr>
      <tr>
        <td><strong>Hypothesize</strong></td>
        <td>CF, PUSH/POP, HYPOTHESIZE</td>
        <td>Exploring possibilities</td>
      </tr>
      <tr>
        <td><strong>Prove</strong></td>
        <td>PROVE, ASK, EXPLAIN</td>
        <td>Deriving and explaining conclusions</td>
      </tr>
    </table>

    <h2>9. Full Metacognitive Example</h2>
    <pre><code># === Domain Setup ===
@r1 SYMPTOM_OF DEFINE_RELATION HAS_SYMPTOM
@r2 TREATS DEFINE_RELATION TREATED_BY

@_ Fever SYMPTOM_OF Infection
@_ Headache SYMPTOM_OF Stress
@_ Aspirin TREATS Headache

# === Self-Assessment ===
@symptoms SYMPTOM_OF FACTS any
@treatments TREATS FACTS any
@symptomCount $symptoms COUNT any
@treatmentCount $treatments COUNT any

# === Hypothetical Reasoning ===
@_ new_symptom_hypothesis PUSH any
@_ Fatigue SYMPTOM_OF Infection
@newSymptoms Infection FACTS any
@_ any POP any

# === Consistency Check ===
@valid any VALIDATE any

# === Explanation ===
@report "We know $symptomCount symptoms and $treatmentCount treatments" TO_NATURAL any</code></pre>

    <h2>Technical References</h2>
    <ul>
      <li><a href="../specsLoader.html?spec=theory/dsl_engine.js.md">DS(/theory/dsl_engine.js)</a> – DSL interpreter</li>
      <li><a href="../specsLoader.html?spec=knowledge/concept_store.js.md">DS(/knowledge/concept_store.js)</a> – Knowledge persistence</li>
      <li><a href="../specsLoader.html?spec=knowledge/theory_stack.js.md">DS(/knowledge/theory_stack.js)</a> – Theory layering</li>
      <li><a href="../specsLoader.html?spec=reason/reasoner.js.md">DS(/reason/reasoner.js)</a> – Basic reasoner</li>
      <li><a href="../specsLoader.html?spec=reason/contradiction_detection.md">DS(/reason/contradiction_detection)</a> – Contradiction detection specification</li>
      <li><a href="../specsLoader.html?spec=reason/inference_engine.md">DS(/reason/inference_engine)</a> – Complete inference engine specification</li>
      <li><a href="../wiki/memory_management.html">Wiki: Memory Management</a></li>
      <li><a href="../wiki/theory_layers.html">Wiki: Theory Layers</a></li>
    </ul>
  </article>

  <div class="footer-nav">
    <a href="index.html">Back to Syntax overview</a>
    <a href="../index.html">Back to index</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
