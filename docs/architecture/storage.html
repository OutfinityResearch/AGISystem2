<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Storage Layer</title>
  <link rel="stylesheet" href="../reference/style.css">
</head>
<body>
  <div class="page">
  <div class="nav-header">
    <h1>AGISystem2 – Storage Layer</h1>
    <small>
      <a href="../index.html">Home</a> ·
      <a href="../guides/conceptual_spaces.html">Theory</a> ·
      <a href="index.html">Architecture</a> ·
      <a href="../api/index.html">APIs</a> ·
      <a href="../syntax/index.html">Syntax</a> ·
      <a href="../usage-cli/index.html">CLI</a> ·
      <a href="../wiki/index.html">Wiki</a> ·
      <a href="../specs/matrix.html">Specs</a>
    </small>
    <div class="sub-nav">
      <strong>Architecture:</strong>
      <a href="index.html">Overview</a> ·
      <a href="geometry.html">Geometry</a> ·
      <a href="knowledge.html">Knowledge</a> ·
      <a href="learning.html">Learning</a> ·
      <a href="reasoning.html">Reasoning</a> ·
      <a href="inference.html">Inference</a> ·
      <a href="language.html">Language</a> ·
      <a href="storage.html">Storage</a> ·
      <a href="configuration.html">Configuration</a> ·
      <a href="evalsuite.html">Eval Suite</a>
    </div>
  </div>

  <p>The Storage Layer handles persistence of concepts, theories, and audit logs. It provides a uniform interface through the StorageAdapter, with pluggable backends for disk, memory, or custom storage systems.</p>

  <div class="section-intro">
    <p><strong>Specification:</strong> DS(/storage/adapter) · DS(/storage/persistence)</p>
  </div>

  <h2>Directory Structure</h2>

  <p>By default, AGISystem2 stores all data in a <code>.AGISystem2/</code> directory in the working directory:</p>

  <pre>
.AGISystem2/
├── data/
│   ├── concepts/           # Binary concept data
│   │   ├── Dog.bin
│   │   ├── Cat.bin
│   │   └── Animal.bin
│   ├── index.json          # Concept name index
│   └── audit/              # Operation logs
│       └── 2024-01-15.log
└── theories/
    ├── base.sys2dsl        # Optional base theory
    ├── medical.sys2dsl     # Named theory files
    └── legal.sys2dsl</pre>

  <h2>StorageAdapter</h2>

  <p>The StorageAdapter provides a uniform interface for storage operations:</p>

  <table class="table-concept-index">
    <thead>
      <tr><th>Method</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td><code>saveConcept(name, data)</code></td><td>Persist concept to storage</td></tr>
      <tr><td><code>loadConcept(name)</code></td><td>Retrieve concept from storage</td></tr>
      <tr><td><code>deleteConcept(name)</code></td><td>Remove concept from storage</td></tr>
      <tr><td><code>listConcepts()</code></td><td>List all stored concept names</td></tr>
      <tr><td><code>saveTheory(name, facts)</code></td><td>Save theory to file</td></tr>
      <tr><td><code>loadTheory(name)</code></td><td>Load theory from file</td></tr>
      <tr><td><code>appendAudit(entry)</code></td><td>Append to audit log</td></tr>
    </tbody>
  </table>

  <h2>Storage Backends</h2>

  <h3>Disk Backend (Default)</h3>
  <p>Stores concepts as binary files and theories as text. Suitable for persistent, file-based workflows.</p>

  <h3>Memory Backend</h3>
  <p>In-memory storage for testing and ephemeral sessions. Data is lost when the process exits.</p>

  <h3>Custom Backends</h3>
  <p>Implement the StorageAdapter interface to connect to databases, cloud storage, or other systems.</p>

  <h2>File Formats</h2>

  <h3>Binary Format (.bin)</h3>
  <p>Efficient storage for concept vectors. Contains: header, vector data, metadata.</p>

  <h3>Theory Format (.sys2dsl)</h3>
  <p>Human-readable text format. One fact per line, comments start with <code>#</code>:</p>

  <pre>
# Medical knowledge base
@_ Aspirin IS_A Drug
@_ Aspirin REDUCES Inflammation
@_ Ibuprofen IS_A Drug</pre>

  <h2>Related Documentation</h2>

  <ul>
    <li><a href="knowledge.html">Knowledge Layer</a> – Concept management</li>
    <li><a href="configuration.html">Configuration</a> – Storage path settings</li>
    <li><a href="../wiki/memory_management.html">Memory Management Wiki</a></li>
  </ul>

  <div class="footer-nav">
    <a href="language.html">← Language</a> ·
    <a href="configuration.html">Configuration →</a>
  </div>
  </div>
  <script src="../reference/nav2.js"></script>
</body>
</html>
