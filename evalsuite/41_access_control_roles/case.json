{
  "id": "41_access_control_roles",
  "name": "Access Control Roles and Separation of Duties",
  "description": "Tests separation of duties and role-based access",

  "theory": {
    "natural_language": "The finance system requires separation of duties: the requester cannot also approve the same purchase. Approvers must hold the 'Approver' role. Requesters hold the 'Requester' role. Alice is a Requester. Bob is an Approver. Cara has both roles, which violates separation.",
    "expected_facts": [
      "separation_of_duties REQUIRES requester_not_approver",
      "Approver ROLE CAN approve_purchase",
      "Requester ROLE CAN request_purchase",
      "Alice HAS_ROLE Requester",
      "Bob HAS_ROLE Approver",
      "Cara HAS_ROLE Requester",
      "Cara HAS_ROLE Approver"
    ]
  },

  "queries": [
    {
      "id": "q1",
      "natural_language": "Can Alice approve her own purchase?",
      "expected_answer": {
        "natural_language": "No. She is a requester and cannot approve under separation of duties.",
        "truth": "FALSE",
        "explanation": "Alice HAS_ROLE Requester ∧ separation_of_duties REQUIRES requester_not_approver"
      }
    },
    {
      "id": "q2",
      "natural_language": "Is Bob allowed to approve purchases?",
      "expected_answer": {
        "natural_language": "Yes. Bob has the Approver role.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Bob HAS_ROLE Approver ∧ Approver ROLE CAN approve_purchase"
      }
    },
    {
      "id": "q3",
      "natural_language": "Does Cara's dual role violate policy?",
      "expected_answer": {
        "natural_language": "Yes. Having both requester and approver roles breaks separation of duties.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Cara HAS_ROLE Requester ∧ Cara HAS_ROLE Approver ∧ separation_of_duties REQUIRES requester_not_approver"
      }
    }
  ],

  "tags": ["access_control", "roles", "separation_of_duties", "policy"]
}
