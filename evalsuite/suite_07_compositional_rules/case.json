{
  "id": "suite_07_compositional_rules",
  "name": "Compositional Rules & Forward Chaining",
  "description": "Tests DEFINE_RULE for user-defined inference rules, FORWARD_CHAIN for exhaustive derivation, and PROVE for proof chain construction",
  "theory": {
    "natural_language": "Genealogy system with derived relations. Basic facts: Ion is the parent of Maria. Maria is the parent of Andrei. Maria is the parent of Elena. Ion is married to Ana. Ana is the parent of Maria. Vasile is the sibling of Ion. Rules to define: A grandparent is a parent of a parent - if X is parent of Y and Y is parent of Z, then X is grandparent of Z. An uncle or aunt is a sibling of a parent - if X is sibling of Y and Y is parent of Z, then X is uncle or aunt of Z. Cousins share a grandparent - if X and Y have a common grandparent and X is not Y and X is not sibling of Y, they are cousins. An ancestor is either a parent or an ancestor of a parent - if X is parent of Y, then X is ancestor of Y; if X is ancestor of Y and Y is parent of Z, then X is ancestor of Z.",
    "expected_facts": [
      "Ion PARENT_OF Maria",
      "Maria PARENT_OF Andrei",
      "Maria PARENT_OF Elena",
      "Ion MARRIED_TO Ana",
      "Ana PARENT_OF Maria",
      "Vasile SIBLING_OF Ion",
      "Vasile PARENT_OF Cosmin"
    ],
    "rules": [
      {
        "name": "grandparent_rule",
        "description": "X is grandparent of Z if X is parent of Y and Y is parent of Z",
        "head": "?x GRANDPARENT_OF ?z",
        "body": [
          "?x PARENT_OF ?y",
          "?y PARENT_OF ?z"
        ]
      },
      {
        "name": "uncle_aunt_rule",
        "description": "X is uncle/aunt of Z if X is sibling of Y and Y is parent of Z",
        "head": "?x UNCLE_OR_AUNT_OF ?z",
        "body": [
          "?x SIBLING_OF ?y",
          "?y PARENT_OF ?z"
        ]
      },
      {
        "name": "ancestor_direct_rule",
        "description": "A parent is an ancestor",
        "head": "?x ANCESTOR_OF ?y",
        "body": [
          "?x PARENT_OF ?y"
        ]
      },
      {
        "name": "ancestor_transitive_rule",
        "description": "Ancestor of parent is also ancestor",
        "head": "?x ANCESTOR_OF ?z",
        "body": [
          "?x ANCESTOR_OF ?y",
          "?y PARENT_OF ?z"
        ]
      },
      {
        "name": "cousin_rule",
        "description": "Cousins share a grandparent but are not siblings",
        "head": "?x COUSIN_OF ?y",
        "body": [
          "?g GRANDPARENT_OF ?x",
          "?g GRANDPARENT_OF ?y",
          "NOT ?x SIBLING_OF ?y",
          "NOT ?x EQUALS ?y"
        ]
      }
    ]
  },
  "queries": [
    {
      "id": "q1",
      "natural_language": "Is Ion the grandparent of Andrei?",
      "expected_dsl": "@q1 Ion GRANDPARENT_OF Andrei",
      "expected_answer": {
        "natural_language": "Yes, Ion is the grandparent of Andrei. Ion is parent of Maria, and Maria is parent of Andrei, so by the grandparent rule, Ion is grandparent of Andrei.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Composition rule: PARENT_OF + PARENT_OF = GRANDPARENT_OF",
        "existence": "positive"
      }
    },
    {
      "id": "q2",
      "natural_language": "Is Ana the grandparent of Elena?",
      "expected_dsl": "@q2 Ana GRANDPARENT_OF Elena",
      "expected_answer": {
        "natural_language": "Yes, Ana is the grandparent of Elena. Ana is parent of Maria, and Maria is parent of Elena.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Composition rule applied to Ana->Maria->Elena chain",
        "existence": "positive"
      }
    },
    {
      "id": "q3",
      "natural_language": "Is Vasile an uncle of Maria?",
      "expected_dsl": "@q3 Vasile UNCLE_OR_AUNT_OF Maria",
      "expected_answer": {
        "natural_language": "Yes, Vasile is an uncle of Maria. Vasile is sibling of Ion, and Ion is parent of Maria.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Uncle rule: SIBLING_OF(Vasile,Ion) + PARENT_OF(Ion,Maria) = UNCLE_OR_AUNT_OF",
        "existence": "positive"
      }
    },
    {
      "id": "q4",
      "natural_language": "Is Ion an ancestor of Andrei?",
      "expected_dsl": "@q4 Ion ANCESTOR_OF Andrei",
      "expected_answer": {
        "natural_language": "Yes, Ion is an ancestor of Andrei through the chain: Ion is parent of Maria (so ancestor), and Maria is parent of Andrei (so Ion is ancestor of Andrei too).",
        "truth": "TRUE_CERTAIN",
        "explanation": "Transitive ancestor rule through two generations",
        "existence": "positive"
      }
    },
    {
      "id": "q5",
      "natural_language": "Are Andrei and Cosmin cousins?",
      "expected_dsl": "@q5 Andrei COUSIN_OF Cosmin",
      "expected_answer": {
        "natural_language": "Yes, Andrei and Cosmin are cousins. They share Ion as a common grandparent (Ion->Maria->Andrei and Ion's sibling Vasile->Cosmin implies shared great-grandparent level), and they are not siblings.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Cousin rule with shared grandparent and NOT sibling",
        "existence": "positive"
      }
    },
    {
      "id": "q6",
      "natural_language": "Why is Ion the grandparent of Andrei?",
      "expected_dsl": "@q6 Ion PROVE Andrei",
      "expected_answer": {
        "natural_language": "Proof chain: 1) Ion PARENT_OF Maria (fact), 2) Maria PARENT_OF Andrei (fact), 3) By grandparent_rule: Ion GRANDPARENT_OF Andrei (derived).",
        "truth": "TRUE_CERTAIN",
        "explanation": "PROVE returns the complete inference chain",
        "existence": "positive"
      }
    },
    {
      "id": "q7",
      "natural_language": "How many new facts can be derived from forward chaining?",
      "expected_dsl": "@q7 FORWARD_CHAIN",
      "expected_answer": {
        "natural_language": "Forward chaining derives multiple new facts: grandparent relations (Ion and Ana are grandparents of Andrei and Elena), uncle relations (Vasile is uncle of Maria), ancestor relations (multiple levels), and cousin relations.",
        "truth": "TRUE_CERTAIN",
        "explanation": "FORWARD_CHAIN exhaustively applies all rules",
        "existence": "positive"
      }
    },
    {
      "id": "q8",
      "natural_language": "Is Andrei a sibling of Elena?",
      "expected_dsl": "@q8 Andrei SIBLING_OF Elena",
      "expected_answer": {
        "natural_language": "Yes, Andrei and Elena are siblings - they share the same parent Maria.",
        "truth": "TRUE_CERTAIN",
        "explanation": "Can be derived from shared parent, or needs explicit sibling fact/rule",
        "existence": "positive"
      }
    }
  ],
  "tags": [
    "rules",
    "composition",
    "forward-chaining",
    "proof",
    "genealogy",
    "inference",
    "comprehensive"
  ],
  "version": "3.0"
}
